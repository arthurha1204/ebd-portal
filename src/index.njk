---
layout: base.njk
title: Início
---

<main>
    <section class="hero">
        <img src="/assets/marca-dagua.png" class="hero-watermark" alt="Marca D'água">
        <div class="container">
            <div style="max-width: 600px;">
                <h1>Ensinar. Instruir. Aprender.</h1>
                <p style="font-size: 1.15rem; margin-bottom: 2rem; opacity: 0.9;">
                    Portal de conteúdo da Escola Bíblica Dominical da Juventude da Catedral da Reconciliação. forjando uma geração firmada nas sagradas escrituras!
                </p>
                <a href="/estudos/" class="btn btn-accent">Explorar Conteúdos</a>
            </div>
        </div>
    </section>

    <div class="container main-grid">
        
        <section>
            <h2 style="border-bottom: 1px solid #e2e8f0; padding-bottom: 1rem; margin-bottom: 2rem;">Últimas Atualizações</h2>
            
            <div id="unified-feed" class="feed-grid">
                {# Variável para contar apenas posts válidos #}
                {% set contador = 0 %}
                
                {% for post in collections.all | reverse %}
                    
                    {# FILTRO: Só entra se não for a própria página, se tiver título E se for de uma pasta de conteúdo #}
                    {% if contador < 6 
                          and post.url != page.url 
                          and post.data.title 
                          and ('/artigos/' in post.url or '/aulas/' in post.url or '/videos/' in post.url or '/livros/' in post.url or '/series/' in post.url) 
                    %}
                    
                        {% set contador = contador + 1 %}

                        <article class="card">
                            <div style="height: 200px; position: relative; overflow:hidden;">
                                
                                {% set badgeColor = "var(--primary-color)" %}
                                {% set typeLabel = "CONTEÚDO" %}
                                
                                {% if '/videos/' in post.url %} 
                                    {% set badgeColor = "#ef4444" %} {% set typeLabel = "VÍDEO" %}
                                {% elif '/aulas/' in post.url %} 
                                    {% set badgeColor = "var(--accent-color)" %} {% set typeLabel = "AULA" %}
                                {% elif '/artigos/' in post.url %} 
                                    {% set badgeColor = "var(--primary-color)" %} {% set typeLabel = "ARTIGO" %}
                                {% elif '/livros/' in post.url %} 
                                    {% set badgeColor = "#d97706" %} {% set typeLabel = "LIVRO" %}
                                {% elif '/series/' in post.url %} 
                                    {% set badgeColor = "#0267a7" %} {% set typeLabel = "SÉRIE" %}
                                {% endif %}
                                
                                <span class="content-type-badge" style="background-color: {{ badgeColor }};">{{ typeLabel }}</span>
                                
                                {% if post.data.image %}
                                    <img src="{{ post.data.image }}" alt="{{ post.data.title }}" style="width:100%; height:100%; object-fit:cover;">
                                {% elif post.data.cover %}
                                    <img src="{{ post.data.cover }}" alt="{{ post.data.title }}" style="width:100%; height:100%; object-fit:cover;">
                                {% else %}
                                    <img src="/assets/fundo.jpg" alt="Capa Padrão" style="width:100%; height:100%; object-fit:cover;">
                                {% endif %}
                            </div>
                            
                            <div class="card-content">
                                <div style="margin-bottom:0.5rem;">
                                    {% for tag in post.data.tags %}
                                        {% if tag != 'post' and tag != 'artigo' and tag != 'aula' and tag != 'video' and tag != 'livro' and tag != 'serie' %}
                                        <a href="/pesquisa/?tag={{ tag }}" class="tag">{{ tag }}</a>
                                        {% endif %}
                                    {% endfor %}
                                </div>

                                <h3 style="font-size: 1.2rem; margin-top: 0.5rem; margin-bottom: 0.5rem; line-height: 1.3;">{{ post.data.title }}</h3>
                                
                                <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1rem;">
                                    {{ post.date | postDate }} • {{ post.data.author }}
                                </p>
                                
                                {% if post.data.description or post.data.resumo %}
                                <p style="font-size: 0.9rem; margin-bottom: 1.5rem; color: #333; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                    {{ post.data.description or post.data.resumo }}
                                </p>
                                {% endif %}
                                
                                <a href="{{ post.url }}" class="btn btn-outline" style="width: 100%; margin-top: auto;">VER CONTEÚDO</a>
                            </div>
                        </article>

                    {% endif %}
                {% endfor %}
            </div>
            
            <div style="text-align: center; margin-top: 3rem;">
                <a href="/estudos/" class="btn btn-primary">VER MAIS ESTUDOS &rarr;</a>
            </div>
        </section>

        <aside>
            <div class="sidebar-widget">
                <h3>Assuntos Populares</h3>
                <ul id="top-tags-list" class="cat-list">
                    <li><span style="font-size:0.8rem; color:#888;">Carregando tópicos...</span></li>
                </ul>
                <a href="/pesquisa/" style="display:block; margin-top:1rem; font-weight:700; color:var(--accent-color)">Ver Todas &rarr;</a>
            </div>

            <div class="sidebar-widget">
                <h3>Horários</h3>
                <div style="margin-bottom: 1rem;">
                    <strong>Domingo, 17h40</strong><br>
                    <span style="font-size: 0.85rem; color: var(--text-muted);">EBD Juv Recon. <br>Capela Dr. Marcílio<br> Catedral da Reconciliação - IECB</span>
                </div>
            </div>

            <div class="sidebar-widget">
                <h3>Última Pregação</h3>
                <div id="latest-video-container">
                    <span style="font-size: 0.8rem; color: #888;">Carregando vídeo...</span>
                </div>
                <div style="margin-top: 1rem; text-align: center;">
                     <a href="https://www.youtube.com/@parareconciliar/streams" target="_blank" class="btn btn-outline" style="font-size: 0.75rem; padding: 0.5rem 1rem; width: 100%;">VER CANAL COMPLETO</a>
                </div>
            </div>
        </aside>
    </div>

    <section class="about-section">
        <div class="container">
            <div class="bible-verse-box">
                <p class="bible-verse-text">
                    "Toda a Escritura é inspirada por Deus e útil para o ensino, para a repreensão, para a correção e para a instrução na justiça, para que o homem de Deus seja apto e plenamente preparado para toda boa obra."
                </p>
                <span class="bible-verse-ref">2 TIMÓTEO 3:16-17</span>
            </div>

            <div class="about-split-layout">
                <div class="story-video-container">
                    <video autoplay loop muted playsinline><source src="/assets/story.mp4" type="video/mp4"></video>
                </div>

                <div class="about-content">
                    <h2>Quem somos?</h2>
                    <p>A EBD Juv Recon é uma comunidade viva de discípulos comprometidos em viver o Evangelho de forma integral. Nosso propósito é claro: não apenas informar a mente, mas transformar o coração através da exposição fiel das Escrituras para a nossa geração.</p>

                    <div class="benefits-list">
                        <div class="benefit-item">
                            <div class="benefit-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg></div>
                            <div class="benefit-text">
                                <h4>Muito Mais que Palestra</h4>
                                <p>Aqui ninguém dorme ouvindo monólogo. Nossas aulas são espaços vivos de diálogo, onde sua dúvida é respeitada e o debate é incentivado.</p>
                            </div>
                        </div>
                        <div class="benefit-item">
                            <div class="benefit-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg></div>
                            <div class="benefit-text">
                                <h4>Bíblia Aberta, Mente Ativa</h4>
                                <p>Não ficamos no raso. Encaramos os textos difíceis, a história e o contexto original para entender o que Deus realmente disse, sem filtros.</p>
                            </div>
                        </div>
                        <div class="benefit-item">
                            <div class="benefit-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg></div>
                            <div class="benefit-text">
                                <h4>Fé para a Vida Real</h4>
                                <p>O que aprendemos domingo de manhã precisa fazer sentido na segunda-feira. Conectamos a teologia com sua faculdade, trabalho e dilemas reais.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stats-container">
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-number" id="classCounter">+80</span>
                        <span class="stat-label">Aulas Ministradas</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-number" id="seriesCounter">+16</span>
                        <span class="stat-label">Séries Abordadas</span>
                    </div>
                </div>
                <span class="stat-sub">E CADA VEZ AUMENTANDO!</span>
                <div class="stat-footer">
                    <span class="stat-highlight">e o melhor, É GRATUITO!</span>
                    <p class="stat-location">Domingo, 17:40h na Capela Dr Marcílio<br>Catedral da Reconciliação - IECB</p>
                </div>
            </div>

            <div class="gallery-section">
                <div class="gallery-title">Nossa Galeria</div>
                <div class="carousel-container">
                    <div class="carousel-track">
                        <div class="carousel-slide"><img src="/assets/galeria-1.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-2.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-3.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-4.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-5.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-1.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-2.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-3.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-4.jpg"></div>
                        <div class="carousel-slide"><img src="/assets/galeria-5.jpg"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // 1. CARREGAR VÍDEO YOUTUBE
        async function fetchLatestVideo() {
            const rssUrl = `https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?user=paraReconciliar`;
            const container = document.getElementById('latest-video-container');
            
            try {
                const response = await fetch(rssUrl);
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const video = data.items[0]; 
                    const videoId = video.guid.split(':')[2]; 
                    const thumbUrl = `https://img.youtube.com/vi/${videoId}/mqdefault.jpg`;
                    
                    const html = `
                        <a href="${video.link}" target="_blank" style="display: block; text-decoration: none; group">
                            <div style="position: relative; overflow: hidden; border-radius: 6px; margin-bottom: 0.8rem;">
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.6); padding: 10px; border-radius: 50%;">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="#fff"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                                </div>
                                <img src="${thumbUrl}" style="width: 100%; display: block; transition: 0.3s;">
                            </div>
                            <h4 style="font-size: 0.95rem; color: var(--primary-color); line-height: 1.4; margin-bottom: 0.2rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                ${video.title}
                            </h4>
                            <span style="font-size: 0.75rem; color: #64748B;">
                                Postado em: ${new Date(video.pubDate).toLocaleDateString('pt-BR')}
                            </span>
                        </a>
                    `;
                    container.innerHTML = html;
                }
            } catch (error) {
                console.error('Erro:', error);
                container.innerHTML = '<p style="font-size:0.8rem; color: #888;">Assista ao vivo no YouTube.</p>';
            }
        }

        // 2. CARREGAR TAGS POPULARES (Lógica Nova)
        async function loadTopTags() {
            try {
                const response = await fetch('/search-index.json');
                const data = await response.json();
                
                const tagCounts = {};
                data.forEach(item => {
                    if(item.tags) {
                        item.tags.forEach(tag => {
                            // Ignora tags internas/técnicas
                            if(!['post','artigo','aula','video','livro','serie'].includes(tag.toLowerCase())) {
                                tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                            }
                        });
                    }
                });

                // Ordena do maior para o menor e pega os top 10
                const sortedTags = Object.entries(tagCounts)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 10);

                const list = document.getElementById('top-tags-list');
                list.innerHTML = '';
                
                sortedTags.forEach(([tagName, count]) => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="/pesquisa/?tag=${encodeURIComponent(tagName)}" style="display:flex; justify-content:space-between;">
                                        ${tagName} <span style="color:#ccc; font-size:0.8rem;">(${count})</span>
                                    </a>`;
                    list.appendChild(li);
                });
            } catch (e) { console.error("Erro tags", e); }
        }

        // 3. ANIMAÇÃO NÚMEROS
        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            if(!obj) return;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = "+" + Math.floor(progress * (end - start) + start);
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        // INICIALIZAÇÃO
        document.addEventListener('DOMContentLoaded', () => {
            fetchLatestVideo();
            loadTopTags(); // Chama a função das tags
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        animateValue("classCounter", 0, 80, 2000);
                        animateValue("seriesCounter", 0, 16, 2000);
                        observer.unobserve(entry.target);
                    }
                });
            });
            const statsSection = document.querySelector('.stats-container');
            if(statsSection) observer.observe(statsSection);
        });
    </script>
</main>